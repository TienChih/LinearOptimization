<?xml version="1.0" encoding="UTF-8"?>

<section xml:id="sec-simplexmax" xmlns:xi="http://www.w3.org/2001/XInclude">
  <title>The Simplex Algorithm for Canonical Maximization</title>


  <activity xml:id="activity-tableaufeasible">
    <task>
      <p>
        Consider the following  tableau:
        <me>
          \begin{array}{|cccc|c|c}          
          x_1 \amp t_3 \amp t_1 \amp x_4 \amp -1 \amp \\
          \hline
           2 \amp 4 \amp 6 \amp 5 \amp 3 \amp -x_4\\
           -3 \amp 0 \amp \frac{2}{3} \amp -2 \amp -1 \amp -x_2\\
           \frac{17}{4} \amp -1 \amp 4 \amp \frac{2}{3} \amp -2 \amp -t_3\\
          \hline
          5 \amp -1 \amp 0 \amp 3 \amp -244 \amp f\\
          \hline
          \end{array} 
         </me>
      </p>
      <p>
        Note that each <m>x_1, t_3, t_1, x_4=0</m> for this tableau.  Write out the corresponding system of canonical inequalities (this should be easy, almost everything is zero).  Are they all satisfied?
      </p>
      
    </task>
    <task>
      <statement>
        <p>
          Which of the following is an if and only if condition for a Tucker Tableau to correspond to a feasible solution?
        </p>
        <ol marker="A." cols="2">
          <li>
            <p>
              Some of the <m>c_j\leq 0</m>.
            </p>
          </li>
          <li>
            <p>
              All of the <m>c_j\leq 0</m>.
            </p>
          </li>
          <li>
            <p>
              Some of the <m>c_j\geq 0</m>.
            </p>
          </li>
          <li>
            <p>
              All of the <m>c_j\geq 0</m>.
            </p>
          </li>
  
          <li>
            <p>
              Some of the <m>b_i\leq 0</m>.
            </p>
          </li>
          <li>
            <p>
              All of the <m>b_i\leq 0</m>.
            </p>
          </li>
          <li>
            <p>
              Some of the <m>b_i\geq 0</m>.
            </p>
          </li>
          <li>
            <p>
              All of the <m>b_i\geq 0</m>.
            </p>
          </li>
        </ol>
      </statement>
        
    </task>

  </activity>

  <activity xml:id="activity-tableaubounded">
    <introduction>
      <p>
        Consider the following  tableau:
        <me>
          \begin{array}{|cccc|c|c}          
          x_3 \amp t_3 \amp x_2 \amp t_1 \amp -1 \amp \\
          \hline
          -4 \amp 25 \amp -3 \amp 2 \amp 18 \amp -t_2\\
          -1  \amp 2 \amp 2  \amp -1\amp  22 \amp -x_1\\
          -2 \amp 0 \amp -1 \amp -1 \amp 10 \amp -x_4\\
          \hline
          2  \amp 0 \amp -1 \amp 1 \amp -156 \amp f\\
          \hline
          \end{array} 
         </me>
      </p>
      <p>
        Note that each <m>x_3, t_3, x_2, t_1=0</m> for this tableau.  
      </p>
      
    </introduction>
    <task>
      <statement>
        <p>
          Why is this tableau feasible?
        </p>
      </statement>
    </task>

    <task>
      <statement>
        <p>
          Which of the following <m>x_3, t_3, t_1, x_2</m> could we increase from zero to increase our objective function value?
        </p>
      </statement>
    </task>

    <task>
      <statement>
        <p>
          If we increase <m>t_2</m> to 5, are all our inequalities satisfied?  What about 10? 100?
        </p>
      </statement>
    </task>  

    <task>
      <statement>
        <p>
          If we increase <m>x_3</m> to 5, are all our inequalities satisfied?  What about 10? 100?
        </p>
      </statement>
    </task>  

    <task>
      <statement>
        <p>
          What is the largest value we could increase <m>t_2</m> while satisfying our 3 inequalities?  What about <m>x_3</m>?
        </p>
      </statement>
    </task>  

    <task>
      <statement>
        <p>
          Find an if and only if condition for a feasible tableau for a canonical maximization problem to have an unbounded feasible region.
        </p>
        <ol marker="A." cols="2">
          <li>
            <p>
              All of the <m>a_{ij}\leq 0</m>.
            </p>
          </li>
          <li>
            <p>
              There is a row <m>j</m> so that all of the <m>a_{ij}\leq 0</m> in that row.
            </p>
          </li>
          <li>
            <p>
              There is a column <m>i</m> so that all of the <m>a_{ij}\leq 0</m> in that column.
            </p>
          </li>
          <li>
            <p>
              All of the <m>c_j\leq 0</m>.
            </p>
          </li>
  
          <li>
            <p>
              All of the <m>b_i\leq 0</m>.
            </p>
          </li>
          
        </ol>
      </statement>
    </task>

    <task>
      <statement>
        <p>
          Consider the following  tableau:
          <me>
            \begin{array}{|cc|c|c}            
            x_1 \amp x_2 \amp -1 \amp \\  
            \hline
            -2 \amp 1 \amp 12 \amp -t_1\\
             -3  \amp 4 \amp  10 \amp -t_2\\
            \hline
             -4 \amp 1 \amp 0 \amp f\\
            \hline
            \end{array} 
           </me>
           Our previous discussion leads us to believe that <m>x_1</m> may be increased as much as we please, and our two inequalities will remain satisfied.  Yet consider a sketch of the region and function:

        </p>
        <p>
          <interactive desmos="de0i0gneqr"/>
        </p>
        <p>
          It turns out this system still achieves a maximum solution.  Why does this not contradict our previous work?
        </p>
      </statement>
    </task>

    <task>
      <statement>
        <p>
          Find an if and only if condition for a feasible tableau for a canonical maximization problem to have an unbounded objective function.
        </p>
        <ol marker="A." cols="2">
          <li>
            <p>
              All of the <m>a_{ij}\leq 0</m>.
            </p>
          </li>
          <li>
            <p>
              There is a row <m>j</m> so that all of the <m>a_{ij}\leq 0</m> in that row and <m>b_i>0</m>.
            </p>
          </li>
          <li>
            <p>
              There is a row <m>j</m> so that all of the <m>a_{ij}\leq 0</m> in that row and <m>b_i \lt 0</m>.
            </p>
          </li>
          <li>
            <p>
              There is a column <m>i</m> so that all of the <m>a_{ij}\leq 0</m> in that column and <m>c_j>0</m>.
            </p>
          </li>
          <li>
            <p>
              There is a column <m>i</m> so that all of the <m>a_{ij}\leq 0</m> in that column and <m>c_j\lt 0</m>.
            </p>
          </li>
          
        </ol>
      </statement>
    </task>

  </activity>

  <activity>
    <introduction>
      <p>
        Consider the canonical max problem corresponding to:
        <me>
          \begin{array}{|cc|c|c}            
          x_1 \amp x_2 \amp -1 \amp \\  
          \hline
          1 \amp 4 \amp 26 \amp -t_1\\
           2  \amp 3 \amp  22 \amp -t_2\\
           4  \amp 1 \amp  22 \amp -t_2\\ 
          \hline
           8 \amp 7 \amp 0 \amp f\\
          \hline
          \end{array} 
         </me>
      </p>
    </introduction>
    <task>
      <statement>
        <p>
          Let's say we wanted to increase <m>x_2</m> from 0.  What is the largest we could increase <m>x_2</m> to while satisfying all 3 inequalities?
        </p>
        
      </statement>
    </task>
    <task>
      <statement>
        <p>
          Consider a sketch of our feasible region:
          <interactive desmos="oda5mzgqs1"/>
        </p>
        <p>
          We could choose to pivot <m>x_2</m> (<m>y</m> in the sketch) with either <m>t_1, t_2, t_3</m>.  Only one of these would result in a feasible solution.  Looking graphically, which is it?
        </p>
      </statement>
    </task>
    <task>
      <statement>
        <p>
          What's the connection between the two above tasks?
        </p>
      </statement>
    </task>
    <task>
      <statement>
        <p>
          For a canonical linear program encoded by a Tucker tableau:
          <me>
            \begin{array}{|cccc|c|c}
            x_1 \amp x_2 \amp \cdots \amp x_n \amp -1\\
            \hline
            a_{11} \amp a_{12}\amp \cdots \amp a_{1n}\amp b_1 \amp -t_1 \\
            a_{21} \amp a_{22}\amp \cdots \amp a_{2n}\amp b_2 \amp -t_2 \\
            \vdots \amp \vdots \amp \ddots \amp \vdots\amp \vdots \amp\vdots \\
            a_{m1} \amp a_{m2}\amp \cdots \amp a_{mn}\amp b_m \amp -t_m \\
            \hline
            c_1 \amp c_2\amp \cdots \amp c_n \amp d \amp   = f \\
            \hline
            \end{array} 
           </me>
           if we pivot in column <m>j</m>, which row <m>i</m> should we choose?
        </p>
        <ol marker="A." cols="2">
          <li>
            <p>
              Any row <m>i</m>.
            </p>
          </li>
          <li>
            <p>
              Any <m>i</m> as long as <m>a_{ij}>0</m>.
            </p>
          </li>
          <li>
            <p>
              The row <m>i</m> where <m>\frac{b_i}{a_{ij}}</m> is minimized.
            </p>
          </li>
          <li>
            <p>
              The row <m>i</m> where <m>\frac{c_j}{a_{ij}}</m> is minimized.
            </p>
          </li>

          <li>
            <p>
              The row <m>i</m> where <m>\frac{b_i}{a_{ij}}</m> is minimized of of the rows where <m>a_{ij}>0</m>.
            </p>
          </li>
          <li>
            <p>
              The row <m>i</m> where <m>\frac{c_j}{a_{ij}}</m> is minimized of of the rows where <m>a_{ij}>0</m>.
            </p>
          </li>
          
        </ol>
      </statement>
    </task>
    <task>
      <statement>
        <p>
          Based on the observations above, what should be the pivot entry for the following tableau?

          <me>
            \begin{array}{|cc|c|c}            
            x_1 \amp x_2 \amp -1 \amp \\  
            \hline
            3 \amp 4 \amp 10 \amp -t_1\\
             -4  \amp 3 \amp  8 \amp -t_2\\
             2  \amp 1 \amp  5 \amp -t_3\\ 
            \hline
             3 \amp -2 \amp 0 \amp f\\
            \hline
            \end{array} 
           </me>
        </p>
      </statement>
    </task>
  </activity>

  <activity>
    <introduction>
      <p>
        For each of the following tableaus, determine what if any of the following are true:
        <ul>
          <li>
            <p>
              The tableau corresponds to an infeasible solution.
            </p>
          </li>
          <li>
            <p>
              The tableau corresponds to an optimal solution.
            </p>
          </li>
          <li>
            <p>
              The tableau tells us the feasible region is unbounded.
            </p>
          </li>
          <li>
            <p>
              The tableau tells us the objective function is unbounded.
            </p>
          </li>
        </ul>
        If a tableau is feasible but not optimal, determine the legit pivot points
      </p>
    </introduction>
    <task>
      <statement>
        <p>
          <me>
            \begin{array}{|ccc|c|}            
            \hline
            1 \amp 1 \amp 4 \amp 4  \\
            2 \amp 2  \amp 3 \amp  -1  \\
            1 \amp 4  \amp 1 \amp  3  \\ 
            \hline
            1 \amp -2 \amp 2  \amp -5 \\
            \hline
            \end{array} 
           </me>
        </p>
      </statement>

    </task>

    <task>
      <statement>
        <p>
          <me>
            \begin{array}{|ccc|c|}            
            \hline
            -3 \amp 1 \amp 0 \amp 5  \\
            5 \amp -3  \amp 8 \amp  4  \\
            2 \amp 4  \amp 2 \amp  2  \\ 
            \hline
            -2 \amp 3 \amp 0  \amp 2 \\
            \hline
            \end{array} 
          </me>
        </p>
      </statement>
    </task>

    <task>
      <statement>
        <p>
          <me>
            \begin{array}{|ccc|c|}            
            \hline
            3 \amp 4 \amp -1 \amp 2  \\
            6 \amp -3  \amp 2 \amp  1  \\
            4 \amp -2  \amp 0 \amp  3  \\ 
            \hline
            -4 \amp -2 \amp 0  \amp 17 \\
            \hline
            \end{array} 
           </me>
        </p>
      </statement>
    </task>

    <task>
      <statement>
        <p>
          <me>
            \begin{array}{|ccc|c|}            
            \hline
            -4 \amp 3 \amp -2 \amp 2  \\
            0 \amp -1  \amp 4 \amp  0  \\
            -1 \amp 4  \amp 0 \amp  5  \\ 
            \hline
            -2 \amp 3 \amp 2  \amp -34  \\
            \hline
            \end{array} 
          </me>
        </p>
      </statement>
    </task>

    <task>
      <statement>
        <p>
          <me>
            \begin{array}{|ccc|c|}            
            \hline
            1 \amp -1 \amp 0 \amp -2  \\
            -1 \amp -3  \amp 8 \amp  4  \\
            3 \amp 4  \amp 2 \amp  2  \\ 
            \hline
            -2 \amp -3 \amp -5  \amp 9  \\
            \hline
            \end{array} 
          </me>
        </p>
      </statement>
    </task>

    <task>
      <statement>
        <p>
          <me>
            \begin{array}{|ccc|c|}            
            \hline
            3 \amp -2 \amp 6 \amp 3  \\
            4 \amp -3  \amp -3 \amp  0  \\
            -1 \amp 2  \amp 5 \amp  1  \\ 
            \hline
            -1 \amp -4 \amp -2  \amp 54  \\
            \hline
            \end{array} 
          </me>
        </p>
      </statement>
    </task>

    <task>
      <statement>
        <p>
          <me>
            \begin{array}{|ccc|c|}            
            \hline
            0 \amp 1 \amp 0 \amp 4  \\
            2 \amp 2  \amp 8 \amp  6  \\
            2 \amp 0  \amp 3 \amp  3  \\ 
            \hline
            5 \amp 3 \amp -4  \amp -23  \\
            \hline
            \end{array} 
          </me>
        </p>
      </statement>
    </task>
  </activity>

  <p>
    With all this, we finally may define our <em>Simplex Algorithm for Maximum Basic
      Feasible Tableaus</em>.
  </p>

  <definition xml:id="def-simplexcanonmaxbf">
    <statement>
      <p>
        The Simplex Algorithm for Maximum Basic Feasible Tableaus
      </p>
      <ol>
          <li>Ensure that each <m>b_i\geq 0</m>, that is that the solution is feasible. </li>
          <li>IF every <m>c_j\leq 0</m>: STOP the current solution is optimal.  </li>
          <li>PICK a column <m>j</m> such that <m>c_j > 0</m>.  </li>
          <li>IF each <m>a_{1j}, a_{2j}, \ldots, a_{mj}\leq 0 </m>: STOP the objective function is unbounded. </li>
          <li>PICK a row <m>i</m>  that minimizes <m>\left\{ b_i/a_{ij}: b_i > 0 \right\}</m>.</li>
          <li>PIVOT on <m>a_{ij}</m>. </li>
          <li>GOTO 1.</li>
      </ol>
    </statement>
  </definition>

  <activity>
    <introduction>
      <statement>
        <p>
          Apply <xref ref="def-simplexcanonmaxbf"/> to the following tableaus.
        </p>
      </statement>
    </introduction>
    <task>
      <statement>
        <p>
          <me>
            \begin{array}{|cc|c|c}          
            x_1 \amp x_2 \amp -1 \amp \\
            \hline
             2 \amp 1 \amp 8 \amp -t_1\\
             1 \amp 2 \amp 10\amp -t_2\\
            \hline
            30 \amp 50 \amp 0 \amp f\\
            \hline
            \end{array} 
           </me>
        </p>
      </statement>
    </task>

    <task>
      <statement>
        <p>
          <me>
            \begin{array}{|cc|c|c}          
            x_1 \amp x_2 \amp -1 \amp \\
            \hline
             -1 \amp 1 \amp 1 \amp -t_1\\
             1 \amp -1 \amp 3\amp -t_2\\
            \hline
            1 \amp 2 \amp 0 \amp f\\
            \hline
            \end{array} 
           </me>
        </p>
      </statement>
    </task>

    <task>
      <statement>
        <p>
          <me>
            \begin{array}{|cc|c|c}          
            x_1 \amp x_2 \amp -1 \amp \\
            \hline
             -1 \amp 1 \amp 1 \amp -t_1\\
             1 \amp -1 \amp 3\amp -t_2\\
            \hline
            -5 \amp 2 \amp 0 \amp f\\
            \hline
            \end{array} 
           </me>
        </p>
      </statement>
    </task>

    <task>
      <statement>
        <p>
          <me>
            \begin{array}{|cccc|c|c}          
            x_1 \amp x_2 \amp x_3 \amp x_4 \amp -1 \amp \\
            \hline
             1 \amp 1 \amp 1 \amp 0 \amp 1 \amp -t_1\\
             0 \amp 1 \amp 1 \amp 0 \amp 4\amp -t_2\\
             -1 \amp 0 \amp -1 \amp 1 \amp 1\amp -t_3\\
            \hline
            -1 \amp -1 \amp 1 \amp 1 \amp 0 \amp f\\
            \hline
            \end{array} 
           </me>
        </p>
      </statement>
    </task>

  </activity>

  <activity>
    <introduction>
      <p>
        For each of the following tableaus correspond to a problem where the origin is not a feasible solution.
        Determine geometrically which of these have an optimal solution.  Then answer the follow-up questions.
      </p>
    </introduction>

    <task>
      <statement>
        <p>
          <me>
            \begin{array}{|cc|c|c}          
            x_1 \amp x_2 \amp -1 \amp \\
            \hline
             -2 \amp -1 \amp -1 \amp -t_1\\
             1 \amp 5 \amp 15\amp -t_2\\
             2 \amp 3 \amp 18 \amp -t_2\\
            \hline
            5 \amp 9 \amp 0 \amp f\\
            \hline
            \end{array} 
           </me>
        </p>
      </statement>
    </task>

    <task>
      <statement>
        <p>
          <me>
            \begin{array}{|cc|c|c}          
            x_1 \amp x_2 \amp -1 \amp \\
            \hline
             -2 \amp 3 \amp 1 \amp -t_1\\
             2 \amp -6 \amp -5\amp -t_2\\
             5 \amp 1 \amp 7 \amp -t_2\\
            \hline
            3 \amp  5 \amp 0 \amp f\\
            \hline
            \end{array} 
           </me>
        </p>
      </statement>
    </task>
    <task>
      <statement>
        <p>
          For the one problem where the origin is not feasible, but the problem has an optimal solution, what pivot would result in a feasible solution?
        </p>
      </statement>
    </task>

    <task>
      <statement>
        <p>
          If <m>b_{i^*}\lt 0</m>, what should be true about <m>a_{ij^*}</m> so that <m>b_{i^*}</m> is positive afterwards?
        </p>
      </statement>
    </task>
    <task>
      <statement>
        <p>
          Consider the inequality <m>2x_1-3x_2-4x_3\lt -5</m>.  Is there a solution which satisfies this where <m>x_i\geq 0</m>?
        </p>
      </statement>
    </task>

    <task>
      <statement>
        <p>
          Consider the inequality <m>5x_1+x_2+2x_3\lt -10</m>.  Is there a solution which satisfies this where <m>x_i\geq 0</m>?
        </p>
      </statement>
    </task>
  </activity>

  <activity>
    <introduction>
      <p>
        We now want to concoct a scheme to turn all the <m>b_i</m> non-negative, if possible.

      </p>
      <p>
        Consider the tableau: 

        <me>
          \begin{array}{|ccc|c|}          
          \hline
           a_{11} \amp a_{12} \amp a_{13} \amp b_1\\
           a_{21} \amp a_{22} \amp a_{23} \amp b_2\\
           a_{31} \amp a_{32} \amp a_{33} \amp b_3\\
           a_{41} \amp a_{42} \amp a_{43} \amp b_4\\
          \hline
          c_1 \amp  c_2 \amp c_3 \amp 0\\
          \hline
          \end{array} 
         </me>
         Suppose that <m>b_2\lt 0, b_3, b_4>0</m>. We want to turn <m>b_2</m> positive while making sure <m>b_3, b_4</m> stay positive.
      </p>
    </introduction>
    <task>
      <statement>
        <p>
          Suppose each <m>a_{2j}\geq 0</m>, what can we say about the associated problem?
        </p>
      </statement>
    </task>
    <task>
      <statement>
        <p>
          Let's then say <m>a_{22}\lt 0</m>.  If we pivot on <m>a_{22}</m> do  <m>b_2, b_3, b_4</m> increase or decrease?  Are any now guaranteed to be positive or negative?
        </p>
      </statement>
    </task>
    <task>
      <statement>
        <p>
          Let's then say <m>a_{32} >  0</m>.  If we pivot on <m>a_{32}</m>  do  <m>b_2, b_3, b_4</m> increase or decrease?  Are any now guaranteed to be positive or negative?
        </p>
      </statement>
    </task>
    <task>
      <statement>
        <p>
          Let's then say <m>a_{42} \lt  0</m>.  If we pivot on <m>a_{42}</m>  do  <m>b_2, b_3, b_4</m> increase or decrease?  Are any now guaranteed to be positive or negative?
        </p>
      </statement>
    </task>
    <task>
      <statement>
        <p>
          Who should we pivot on?
        </p>
        <ol marker="A." >
          <li>
            <p>
              Any <m>a_{2k}, k\geq 2</m>.
            </p>
          </li>
          <li>
            <p>
              All of the <m>a_{2k}, k\geq 2</m> such that <m>b_k/a_{2k}</m> is minimized.
            </p>
          </li>
          <li>
            <p>
              All of the <m>a_{2k}, k\geq 2</m> such that if <m>k>2</m> then <m>a_{2k}>0</m> and <m>b_k/a_{2k}</m> is minimized.
            </p>
          </li> 
          
        </ol>
      </statement>
    </task>
    <task>
      <statement>
        <p>
          Note that we have no idea if <m>b_1</m> is positive or negative before we started, much less after.  Why don't we care?
        </p>
      </statement>
    </task>
  </activity>

  <p>With this, we may define our algorithm for potentiall non-feasible tableau</p>

  <definition xml:id="def-simplexmax">
    <statement>
      <p>
        The Simplex Algorithm for Maximum Tableaus
      </p>
      <ol>
        <li>IF each <m>b_i\geq 0</m>, GOTO 8. </li>
        <li>PICK the largest <m>i</m> such that <m>b_i\lt 0</m>.  </li>
        <li>IF  <m>a_{i1}, a_{i2}, \ldots, a_{in}\geq 0 </m>: STOP the problem in infeasible. </li>
        <li>PICK a column <m>j</m>  such that <m>a_{ij} \lt 0</m> .</li>
        <li>PICK a row <m>p\geq i</m> so that <m>\displaystyle \min_{k>i}\left(\{b_i/a_{ij}\} \cup \{b_k/a_{kj}:a_{kj}>0\} \right)=b_p/a_{pj}</m>.</li>
        <li>PIVOT on <m>a_{pj}</m>. </li>
        <li>GOTO 1.</li>
        <li>APPLY <xref ref="def-simplexcanonmaxbf"/> .</li>

    </ol>
    </statement>
  </definition>

  <activity>
    <introduction>
      <p>
        Apply <xref ref="def-simplexcanonmax" /> to the following tableau:
      </p>
    </introduction>
    <task>
      <statement>
        <p>
          <me>
            \begin{array}{|cc|c|}          
            \hline
             -1 \amp -2 \amp -3\\
             1 \amp 1 \amp 2\\
            \hline
            2 \amp  -4 \amp 0\\
            \hline
            \end{array} 
           </me>
        </p>
      </statement>
    </task>

    <task>
      <statement>
        <p>
          <me>
            \begin{array}{|cc|c|}          
            \hline
             -3 \amp -2 \amp -6\\
             3 \amp 5 \amp 20\\
             2 \amp 0 \amp 4\\
            \hline
            3 \amp  4 \amp 0\\
            \hline
            \end{array} 
           </me>
        </p>
      </statement>
    </task>
  </activity>

  

</section>

