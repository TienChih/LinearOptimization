<?xml version="1.0" encoding="UTF-8"?>

<section xml:id="sec-cycling" xmlns:xi="http://www.w3.org/2001/XInclude">
  <title>Cycling</title>


  <introduction>
    <p>
      In this section, we discuss a potentially serious hurdle to using the Simplex Algorithm, and show how to avoid it completely.
    </p>
  </introduction>

  

  <activity xml:id="activity-cyclingexample"> 
    <introduction>
      <p>
        Consider the following canonical maximization tableau:
        
      </p>
      <p>
        <tabular halign="center">
          <row>
            <cell halign="left">
            </cell>
            <cell bottom="medium">
              <m>x_1</m>
            </cell>
            <cell bottom="medium">
              <m>x_2</m>
            </cell>
            <cell bottom="medium">
              <m>x_3</m>
            </cell>
            <cell bottom="medium">
              <m>x_4</m>
            </cell>
            <cell bottom="medium">
              <m>-1</m>
            </cell>
            <cell halign="left">
            </cell>
          </row>
          <row>
            <cell halign="left" right="medium">
            </cell>
            <cell>
              <m>-12.5</m>
            </cell>
            <cell>
              <m>-2</m>
            </cell>
            <cell>
              <m>12.5</m>
            </cell>
            <cell right="medium">
              <m>1</m>
            </cell>
            <cell right="medium">
              <m>0</m>
            </cell>
            <cell halign="left">
              <m>=-t_1</m>
            </cell>
          </row>
          
          <row>
            <cell halign="left" right="medium">
            </cell>
            <cell bottom="medium">
              <m>1</m>
            </cell>
            <cell bottom="medium">
              <m>0.24</m>
            </cell>
            <cell bottom="medium">
              <m>-2</m>
            </cell>
            <cell right="medium" bottom="medium">
              <m>-0.24</m>
            </cell>
            <cell right="medium" bottom="medium">
              <m>0</m>
            </cell>
            <cell halign="left">
              <m>=-t_2</m>
            </cell>
          </row>
          <row>
            <cell halign="left" right="medium">
            </cell>
            <cell bottom="medium">
              <m>4</m>
            </cell>
            <cell bottom="medium">
              <m>1.92</m>
            </cell>
            <cell bottom="medium">
              <m>-16</m>
            </cell>
            <cell right="medium" bottom="medium">
              <m>-0.96</m>
            </cell>
            <cell right="medium" bottom="medium">
              <m>1</m>
            </cell>
            <cell halign="left">
              <m>=f</m>
            </cell>
          </row>
        </tabular>
      </p>
    </introduction>
    <task>
      <statement>
        <p>
          Perform the following sequence of pivots, ensure each time that it is a valid pivot according to <xref ref="def-simplexcanonmaxbf"/>, and keep track of the variables.
        </p>
        <p>
          <tabular halign="center">
            <row>
              <cell halign="left">
              </cell>
              <cell bottom="medium">
                <m>?</m>
              </cell>
              <cell bottom="medium">
                <m>?</m>
              </cell>
              <cell bottom="medium">
                <m>?</m>
              </cell>
              <cell bottom="medium">
                <m>?</m>
              </cell>
              <cell bottom="medium">
                <m>-1</m>
              </cell>
              <cell halign="left">
              </cell>
            </row>
            <row>
              <cell halign="left" right="medium">
              </cell>
              <cell>
                <m>-12.5</m>
              </cell>
              <cell>
                <m>-2</m>
              </cell>
              <cell>
                <m>12.5</m>
              </cell>
              <cell right="medium">
                <m>1</m>
              </cell>
              <cell right="medium">
                <m>0</m>
              </cell>
              <cell halign="left">
                <m>=-?</m>
              </cell>
            </row>
            
            <row>
              <cell halign="left" right="medium">
              </cell>
              <cell bottom="medium">
                <m>1^*</m>
              </cell>
              <cell bottom="medium">
                <m>0.24</m>
              </cell>
              <cell bottom="medium">
                <m>-2</m>
              </cell>
              <cell right="medium" bottom="medium">
                <m>-0.24</m>
              </cell>
              <cell right="medium" bottom="medium">
                <m>0</m>
              </cell>
              <cell halign="left">
                <m>=-?</m>
              </cell>
            </row>
            <row>
              <cell halign="left" right="medium">
              </cell>
              <cell bottom="medium">
                <m>4</m>
              </cell>
              <cell bottom="medium">
                <m>1.92</m>
              </cell>
              <cell bottom="medium">
                <m>-16</m>
              </cell>
              <cell right="medium" bottom="medium">
                <m>-0.96</m>
              </cell>
              <cell right="medium" bottom="medium">
                <m>1</m>
              </cell>
              <cell halign="left">
                <m>=f</m>
              </cell>
            </row>
          </tabular>


          <tabular halign="center">
            <row>
              <cell halign="left">
              </cell>
              <cell bottom="medium">
                <m>?</m>
              </cell>
              <cell bottom="medium">
                <m>?</m>
              </cell>
              <cell bottom="medium">
                <m>?</m>
              </cell>
              <cell bottom="medium">
                <m>?</m>
              </cell>
              <cell bottom="medium">
                <m>-1</m>
              </cell>
              <cell halign="left">
              </cell>
            </row>
            <row>
              <cell halign="left" right="medium">
              </cell>
              <cell>
                <m>?</m>
              </cell>
              <cell>
                <m>?^*</m>
              </cell>
              <cell>
                <m>?</m>
              </cell>
              <cell right="medium">
                <m>?</m>
              </cell>
              <cell right="medium">
                <m>?</m>
              </cell>
              <cell halign="left">
                <m>=-?</m>
              </cell>
            </row>
            
            <row>
              <cell halign="left" right="medium">
              </cell>
              <cell bottom="medium">
                <m>?</m>
              </cell>
              <cell bottom="medium">
                <m>?</m>
              </cell>
              <cell bottom="medium">
                <m>?</m>
              </cell>
              <cell right="medium" bottom="medium">
                <m>?</m>
              </cell>
              <cell right="medium" bottom="medium">
                <m>?</m>
              </cell>
              <cell halign="left">
                <m>=-?</m>
              </cell>
            </row>
            <row>
              <cell halign="left" right="medium">
              </cell>
              <cell bottom="medium">
                <m>?</m>
              </cell>
              <cell bottom="medium">
                <m>?</m>
              </cell>
              <cell bottom="medium">
                <m>?</m>
              </cell>
              <cell right="medium" bottom="medium">
                <m>?</m>
              </cell>
              <cell right="medium" bottom="medium">
                <m>?</m>
              </cell>
              <cell halign="left">
                <m>=f</m>
              </cell>
            </row>
          </tabular>


          <tabular halign="center">
            <row>
              <cell halign="left">
              </cell>
              <cell bottom="medium">
                <m>?</m>
              </cell>
              <cell bottom="medium">
                <m>?</m>
              </cell>
              <cell bottom="medium">
                <m>?</m>
              </cell>
              <cell bottom="medium">
                <m>?</m>
              </cell>
              <cell bottom="medium">
                <m>-1</m>
              </cell>
              <cell halign="left">
              </cell>
            </row>
            <row>
              <cell halign="left" right="medium">
              </cell>
              <cell>
                <m>?</m>
              </cell>
              <cell>
                <m>?</m>
              </cell>
              <cell>
                <m>?</m>
              </cell>
              <cell right="medium">
                <m>?</m>
              </cell>
              <cell right="medium">
                <m>?</m>
              </cell>
              <cell halign="left">
                <m>=-?</m>
              </cell>
            </row>
            
            <row>
              <cell halign="left" right="medium">
              </cell>
              <cell bottom="medium">
                <m>?</m>
              </cell>
              <cell bottom="medium">
                <m>?</m>
              </cell>
              <cell bottom="medium">
                <m>?^*</m>
              </cell>
              <cell right="medium" bottom="medium">
                <m>?</m>
              </cell>
              <cell right="medium" bottom="medium">
                <m>?</m>
              </cell>
              <cell halign="left">
                <m>=-?</m>
              </cell>
            </row>
            <row>
              <cell halign="left" right="medium">
              </cell>
              <cell bottom="medium">
                <m>?</m>
              </cell>
              <cell bottom="medium">
                <m>?</m>
              </cell>
              <cell bottom="medium">
                <m>?</m>
              </cell>
              <cell right="medium" bottom="medium">
                <m>?</m>
              </cell>
              <cell right="medium" bottom="medium">
                <m>?</m>
              </cell>
              <cell halign="left">
                <m>=f</m>
              </cell>
            </row>
          </tabular>

          <tabular halign="center">
            <row>
              <cell halign="left">
              </cell>
              <cell bottom="medium">
                <m>?</m>
              </cell>
              <cell bottom="medium">
                <m>?</m>
              </cell>
              <cell bottom="medium">
                <m>?</m>
              </cell>
              <cell bottom="medium">
                <m>?</m>
              </cell>
              <cell bottom="medium">
                <m>-1</m>
              </cell>
              <cell halign="left">
              </cell>
            </row>
            <row>
              <cell halign="left" right="medium">
              </cell>
              <cell>
                <m>?</m>
              </cell>
              <cell>
                <m>?</m>
              </cell>
              <cell>
                <m>?</m>
              </cell>
              <cell right="medium">
                <m>?^*</m>
              </cell>
              <cell right="medium">
                <m>?</m>
              </cell>
              <cell halign="left">
                <m>=-?</m>
              </cell>
            </row>
            
            <row>
              <cell halign="left" right="medium">
              </cell>
              <cell bottom="medium">
                <m>?</m>
              </cell>
              <cell bottom="medium">
                <m>?</m>
              </cell>
              <cell bottom="medium">
                <m>?</m>
              </cell>
              <cell right="medium" bottom="medium">
                <m>?</m>
              </cell>
              <cell right="medium" bottom="medium">
                <m>?</m>
              </cell>
              <cell halign="left">
                <m>=-?</m>
              </cell>
            </row>
            <row>
              <cell halign="left" right="medium">
              </cell>
              <cell bottom="medium">
                <m>?</m>
              </cell>
              <cell bottom="medium">
                <m>?</m>
              </cell>
              <cell bottom="medium">
                <m>?</m>
              </cell>
              <cell right="medium" bottom="medium">
                <m>?</m>
              </cell>
              <cell right="medium" bottom="medium">
                <m>?</m>
              </cell>
              <cell halign="left">
                <m>=f</m>
              </cell>
            </row>
          </tabular>

          <tabular halign="center">
            <row>
              <cell halign="left">
              </cell>
              <cell bottom="medium">
                <m>?</m>
              </cell>
              <cell bottom="medium">
                <m>?</m>
              </cell>
              <cell bottom="medium">
                <m>?</m>
              </cell>
              <cell bottom="medium">
                <m>?</m>
              </cell>
              <cell bottom="medium">
                <m>-1</m>
              </cell>
              <cell halign="left">
              </cell>
            </row>
            <row>
              <cell halign="left" right="medium">
              </cell>
              <cell>
                <m>?</m>
              </cell>
              <cell>
                <m>?</m>
              </cell>
              <cell>
                <m>?</m>
              </cell>
              <cell right="medium">
                <m>?</m>
              </cell>
              <cell right="medium">
                <m>?</m>
              </cell>
              <cell halign="left">
                <m>=-?</m>
              </cell>
            </row>
            
            <row>
              <cell halign="left" right="medium">
              </cell>
              <cell bottom="medium">
                <m>?^*</m>
              </cell>
              <cell bottom="medium">
                <m>?</m>
              </cell>
              <cell bottom="medium">
                <m>?</m>
              </cell>
              <cell right="medium" bottom="medium">
                <m>?</m>
              </cell>
              <cell right="medium" bottom="medium">
                <m>?</m>
              </cell>
              <cell halign="left">
                <m>=-?</m>
              </cell>
            </row>
            <row>
              <cell halign="left" right="medium">
              </cell>
              <cell bottom="medium">
                <m>?</m>
              </cell>
              <cell bottom="medium">
                <m>?</m>
              </cell>
              <cell bottom="medium">
                <m>?</m>
              </cell>
              <cell right="medium" bottom="medium">
                <m>?</m>
              </cell>
              <cell right="medium" bottom="medium">
                <m>?</m>
              </cell>
              <cell halign="left">
                <m>=f</m>
              </cell>
            </row>
          </tabular>

          <tabular halign="center">
            <row>
              <cell halign="left">
              </cell>
              <cell bottom="medium">
                <m>?</m>
              </cell>
              <cell bottom="medium">
                <m>?</m>
              </cell>
              <cell bottom="medium">
                <m>?</m>
              </cell>
              <cell bottom="medium">
                <m>?</m>
              </cell>
              <cell bottom="medium">
                <m>-1</m>
              </cell>
              <cell halign="left">
              </cell>
            </row>
            <row>
              <cell halign="left" right="medium">
              </cell>
              <cell>
                <m>?</m>
              </cell>
              <cell>
                <m>?^*</m>
              </cell>
              <cell>
                <m>?</m>
              </cell>
              <cell right="medium">
                <m>?</m>
              </cell>
              <cell right="medium">
                <m>?</m>
              </cell>
              <cell halign="left">
                <m>=-?</m>
              </cell>
            </row>
            
            <row>
              <cell halign="left" right="medium">
              </cell>
              <cell bottom="medium">
                <m>?</m>
              </cell>
              <cell bottom="medium">
                <m>?</m>
              </cell>
              <cell bottom="medium">
                <m>?</m>
              </cell>
              <cell right="medium" bottom="medium">
                <m>?</m>
              </cell>
              <cell right="medium" bottom="medium">
                <m>?</m>
              </cell>
              <cell halign="left">
                <m>=-?</m>
              </cell>
            </row>
            <row>
              <cell halign="left" right="medium">
              </cell>
              <cell bottom="medium">
                <m>?</m>
              </cell>
              <cell bottom="medium">
                <m>?</m>
              </cell>
              <cell bottom="medium">
                <m>?</m>
              </cell>
              <cell right="medium" bottom="medium">
                <m>?</m>
              </cell>
              <cell right="medium" bottom="medium">
                <m>?</m>
              </cell>
              <cell halign="left">
                <m>=f</m>
              </cell>
            </row>
          </tabular>


        </p>
        
        
      </statement>
    </task>

    <task>
      <statement>
        <p>
          Compare your final tableau to the initial tableau.  Are there any similarities?
        </p>
      </statement>
    </task>
      
  </activity>


  <activity>
    <introduction>
      <p>
        Consider the canonical linear optimization problem: Maximize <m>f(x,y)=x+y</m>, subject to
        <md>
          <mrow>-2x +y \amp\leq0 </mrow>
          <mrow>x -2y \amp\leq0 </mrow>
          <mrow> x +y \amp\leq4 </mrow>
          <mrow>x,y \amp\geq0. </mrow>
        </md>
      </p>
    </introduction>
    <task>
      <statement>
        <p>
          Consider a sequence of pivots swapping <m>x\leftrightarrow t_2</m>, <m>y \leftrightarrow  t_1</m> <m>t_1 \leftrightarrow y</m>, <m>t_2 \leftrightarrow x</m>.  In each of these cases, what is the basic solution
          recorded by the tableau?
        </p>
        <p>
           <image xml:id="degenerate" width="80%"> 
          <description>The feasible region with multiple lines intersecting the origin.</description>
          <latex-image>
            \begin{tikzpicture}
                \draw[fill, blue, opacity=0.4] (0,0) -- (4/3,8/3) -- (8/3, 4/3)  -- (0,0);
                \draw[very thick,->] (-0.5,0) -- (4.5,0);
                \draw[very thick,->] (0,-0.5) -- (0, 4.5);
                \foreach \x in {0,...,4}\draw (\x cm,1pt) -- (\x cm,-1pt) node[anchor=north] {\tiny $\mathbf{\x}$};
                \foreach \y in {0,...,4}\draw (1pt,\y cm) -- (-1pt,\y cm) node[anchor=east] {\tiny $\mathbf{\y}$};
                \draw[black, thick] (0,0) -- (4/3,8/3) -- (8/3,4/3) -- (0,0);
                \draw[red, dashed, thick] (-0.5,-0.25) --node[below, sloped, pos=0.45]{\small $2x+y=0$} (4.5, 2.25);
                \draw[teal, dashed, thick, pos=0.7] (-0.25,-0.5) --node[above left, sloped]{\small$x+2y=0$} (2.25, 4.5);
                \draw[ fill] (0,0) node[above left]{\small$(0,0)$} circle (2pt); 
                \draw[ fill] (4/3,8/3) node[ above right]{\small$(4/3,8/3)$} circle (2pt); 
                \draw[ fill] (8/3,4/3) node[ right]{\small$(8/3,4/3)$} circle (2pt); 
                
              \end{tikzpicture}
  
            </latex-image>
        </image> 
        </p>
      </statement>
       
    </task>
  </activity>

  <definition xml:id="def-Cycling">
    <idx>cycling</idx>
    <statement>
      <p>
        If a series of pivots in accordance to <xref ref="def-simplexcanonmaxbf"/> allows one to return to a set of basic variables achieved earlier in the algorithm, 
        we call this phenomenon <term>cycling</term>.
      </p>
    </statement>
  </definition>

  <definition xml:id="def-degenerate">
    <idx>degenerate</idx>
    <statement>
      <p>
        If a pivot on a tableau gives a new tableau corresponding to the same basic solution, we call the pivot a <term>degenerate</term> pivot.
      </p>
    </statement>
  </definition>

  <p>
    Cycling is bad, since potentially this allows the Simplex Algorithm to not terminate.  Fortunately, there is a solution to this issue.
  </p>

  <theorem xml:id="thm-BlandAnticycling">
    <idx>Bland's anticycling rules</idx>
    <idx>anticycling</idx>
    <idx>theorem, Bland's anticycling</idx>
    <title>Bland's Anticycling Rules</title>
    
    
    <statement>
      <p>
        List all variables, independent and dependent in the initial tableau.  Then consider the following rules:
      </p>
      <ol>
        <li>
          <p>
            Whenever there is more than one possible choice for a pivot row according to <xref ref="def-simplexcanonmaxbf"/>:  select the row corresponding to the variable closest to the front of the initial list.
          </p>
        </li>
        <li>
          <p>
            Whenever there is more than one possible choice for a pivot column according to <xref ref="def-simplexcanonmaxbf"/>:  select the column corresponding to the variable closest to the front of the initial list.
          </p>
        </li>
      </ol>
      <p>
        Then the Simplex Algorthm will not cycle.
      </p>
    </statement>
  </theorem>

  <proof>
    <p>
      For the sake of notation, we denote the initial tableau:
      
       <tabular halign="center">
        <row>
          <cell halign="left">
          </cell>
          <cell bottom="medium">
            <m>x_1</m>
          </cell>
          <cell bottom="medium">
            <m>x_2</m>
          </cell>
          <cell bottom="medium">
            <m>\cdots</m>
          </cell>
          <cell bottom="medium">
            <m>x_m</m>
          </cell>
          <cell bottom="medium">
            <m>-1</m>
          </cell>
          <cell halign="left">
          </cell>
        </row>
        <row>
          <cell halign="left" right="medium">
          </cell>
          <cell>
            <m>a_{11}</m>
          </cell>
          <cell>
            <m>a_{12}</m>
          </cell>
          <cell>
            <m>\cdots</m>
          </cell>
          <cell right="medium">
            <m>a_{1m}</m>
          </cell>
          <cell right="medium">
            <m>b_1</m>
          </cell>
          <cell halign="left">
            <m>=-x_{m+1}</m>
          </cell>
        </row>
        <row>
          <cell halign="left" right="medium">
          </cell>
          <cell>
            <m>a_{21}</m>
          </cell>
          <cell>
            <m>a_{22}</m>
          </cell>
          <cell>
            <m>\cdots</m>
          </cell>
          <cell right="medium">
            <m>a_{2m}</m>
          </cell>
          <cell right="medium">
            <m>b_2</m>
          </cell>
          <cell halign="left">
            <m>=-x_{m+2}</m>
          </cell>
        </row>
        <row>
          <cell halign="left" right="medium">
          </cell>
          <cell>
            <m>\vdots</m>
          </cell>
          <cell>
            <m>\vdots</m>
          </cell>
          <cell>
            <m>\ddots</m>
          </cell>
          <cell right="medium">
            <m>\vdots</m>
          </cell>
          <cell right="medium">
            <m>\vdots</m>
          </cell>
          <cell halign="left">
            <m>\vdots</m>
          </cell>
        </row>
        
        <row>
          <cell halign="left" right="medium">
          </cell>
          <cell bottom="medium">
            <m>a_{n1}</m>
          </cell>
          <cell bottom="medium">
            <m>a_{n2}</m>
          </cell>
          <cell bottom="medium">
            <m>\cdots</m>
          </cell>
          <cell right="medium" bottom="medium">
            <m>a_{nm}</m>
          </cell>
          <cell right="medium" bottom="medium">
            <m>b_n</m>
          </cell>
          <cell halign="left">
            <m>=-x_{m+n}</m>
          </cell>
        </row>
        <row>
          <cell halign="left" right="medium">
          </cell>
          <cell bottom="medium">
            <m>c_1</m>
          </cell>
          <cell bottom="medium">
            <m>c_2</m>
          </cell>
          <cell bottom="medium">
            <m>\cdots</m>
          </cell>
          <cell right="medium" bottom="medium">
            <m>c_m</m>
          </cell>
          <cell right="medium" bottom="medium">
            <m>d</m>
          </cell>
          <cell halign="left">
            <m>=f</m>
          </cell>
        </row>
      </tabular>
       and order the variables in the associated way.  Suppose we follow Bland's rules and still have cycling.
       That is, there is a sequence of pivots and bases (set of basic variables) <m>B_1\to B_2\to \cdots B_\ell \to B_1</m>.
       We call a variable <m>x_j</m> <term>fickle</term> if <m>x_j</m> is in one, but not all of the bases.  That is, it leaves a basis, and reenters it later during the cycle.

    </p>
    <p>
      Note that in order for cycling to occur, each pivot must be degenerate (ask yourself why?).
        So if <m>x_j</m> is fickle, <m>x_j=0</m> for each basic solution during the cycle.
    </p>
    <p>
      Since the number of variables is finite, the set of fickle variables is also finite, and let <m>x_t</m> 
      denote the fickle variable with largest subscript.  Suppose that <m>x_t \in B_i, x_t\not\in B_{i+1}</m> (why must such a <m>B_i</m> exist?).
      Denote the entering variable from <m>B_i\to B_{i+1}</m> with <m>x_s</m>.

      
       <sidebyside widths="50% 50%" valign="middle" margins="0% 0%">
        <tabular halign="center">
          <row>
            <cell halign="right">
            </cell>
            <cell bottom="medium">
              <m>\cdots</m>
            </cell>
            <cell bottom="medium">
              <m>x_s</m>
            </cell>
            <cell bottom="medium">
              <m>\cdots</m>
            </cell>
            <cell bottom="medium">
              <m>-1</m>
            </cell>
            <cell halign="left">
            </cell>
          </row>
          <row>
            <cell halign="right" right="medium">
            </cell>
            <cell>
              <m>\cdots</m>
            </cell>
            <cell>
              <m>\cdots</m>
            </cell>
            <cell right="medium">
              <m>\cdots</m>
            </cell>
            <cell right="medium">
              <m>\vdots</m>
            </cell>
            <cell halign="left">
            </cell>
          </row>
          <row>
            <cell halign="left" right="medium">
            </cell>
            <cell>
              <m>\vdots</m>
            </cell>
            <cell>
              <m>a_{ts}</m>
            </cell>
            <cell right="medium">
              <m>\vdots</m>
            </cell>
            <cell right="medium">
              <m>0</m>
            </cell>
            <cell halign="left">
              <m>=-x_{t}</m>
            </cell>
          </row>
          <row>
            <cell halign="right" right="medium">
            </cell>
            <cell bottom="medium">
              <m>\cdots</m>
            </cell>
            <cell bottom="medium">
              <m>\cdots</m>
            </cell>
            <cell right="medium" bottom="medium">
              <m>\cdots</m>
            </cell>
            <cell right="medium" bottom="medium">
              <m>\vdots</m>
            </cell>
            <cell halign="left">
            </cell>
          </row>
          <row>
            <cell halign="right" right="medium">
            </cell>
            <cell bottom="medium">
              <m>\cdots</m>
            </cell>
            <cell bottom="medium">
              <m>c_s</m>
            </cell>
            <cell right="medium" bottom="medium">
              <m>\cdots</m>
            </cell>
            <cell right="medium" bottom="medium">
              <m>d</m>
            </cell>
            <cell halign="left">
              <m>=f</m>
            </cell>
          </row>
        </tabular>
      
        <tabular halign="center">
          <row>
            <cell halign="right">
            </cell>
            <cell bottom="medium">
              <m>\cdots</m>
            </cell>
            <cell bottom="medium">
              <m>x_t</m>
            </cell>
            <cell bottom="medium">
              <m>\cdots</m>
            </cell>
            <cell bottom="medium">
              <m>-1</m>
            </cell>
            <cell halign="left">
            </cell>
          </row>
          <row>
            <cell halign="right" right="medium">
            </cell>
            <cell>
              <m>\cdots</m>
            </cell>
            <cell>
              <m>\cdots</m>
            </cell>
            <cell right="medium">
              <m>\cdots</m>
            </cell>
            <cell right="medium">
              <m>\vdots</m>
            </cell>
            <cell halign="left">
            </cell>
          </row>
          <row>
            <cell halign="left" right="medium">
            </cell>
            <cell>
              <m>\vdots</m>
            </cell>
            <cell>
              <m>?</m>
            </cell>
            <cell right="medium">
              <m>\vdots</m>
            </cell>
            <cell right="medium">
              <m>0</m>
            </cell>
            <cell halign="left">
              <m>=-x_{s}</m>
            </cell>
          </row>
          <row>
            <cell halign="right" right="medium">
            </cell>
            <cell bottom="medium">
              <m>\cdots</m>
            </cell>
            <cell bottom="medium">
              <m>\cdots</m>
            </cell>
            <cell right="medium" bottom="medium">
              <m>\cdots</m>
            </cell>
            <cell right="medium" bottom="medium">
              <m>\vdots</m>
            </cell>
            <cell halign="left">
            </cell>
          </row>
          <row>
            <cell halign="right" right="medium">
            </cell>
            <cell bottom="medium">
              <m>\cdots</m>
            </cell>
            <cell bottom="medium">
              <m>?</m>
            </cell>
            <cell right="medium" bottom="medium">
              <m>\cdots</m>
            </cell>
            <cell right="medium" bottom="medium">
              <m>d</m>
            </cell>
            <cell halign="left">
              <m>=f</m>
            </cell>
          </row>
        </tabular>
      </sidebyside>
      
       
       Note that <m>x_s</m> must also be fickle (why?) and so <m>s\lt t</m>.
    </p>
    <p>
      We call the <term>dictionary</term> for a basis the system of equations corresponding to that basis.  So the dictionary for <m>B_i</m> is <m>D_i</m>
      which we can write with constraint equalities:
      

        <me>x_k  = b_k - \displaystyle\sum_{x_j\not\in B_i} a_{kj}x_j\text{ for }k\in B_i</me>
        and objective function equality:
        <me>f  = \displaystyle\sum_{x_j\not\in B_i} c_{j}x_j -d.</me>

      Note that since the above pivot was valid, we must have that <m>c_s>0, a_{ts}>0</m> 
      and since the pivot was degenerate, we have <m>b_t=0</m>.
    </p>

    <p>
      Now, because we have cycling, we must have that <m>x_t</m> reenters the basis at some point:
    </p>
    <p>
      <sidebyside widths="50% 50%" valign="middle" margins="0% 0%">
        <tabular halign="center">
          <row>
            <cell halign="right">
            </cell>
            <cell bottom="medium">
              <m>\cdots</m>
            </cell>
            <cell bottom="medium">
              <m>x_t</m>
            </cell>
            <cell bottom="medium">
              <m>\cdots</m>
            </cell>
            <cell bottom="medium">
              <m>-1</m>
            </cell>
            <cell halign="left">
            </cell>
          </row>
          <row>
            <cell halign="right" right="medium">
            </cell>
            <cell>
              <m>\cdots</m>
            </cell>
            <cell>
              <m>\cdots</m>
            </cell>
            <cell right="medium">
              <m>\cdots</m>
            </cell>
            <cell right="medium">
              <m>\vdots</m>
            </cell>
            <cell halign="left">
            </cell>
          </row>
          <row>
            <cell halign="left" right="medium">
            </cell>
            <cell>
              <m>\vdots</m>
            </cell>
            <cell>
              <m>?</m>
            </cell>
            <cell right="medium">
              <m>\vdots</m>
            </cell>
            <cell right="medium">
              <m>0</m>
            </cell>
            <cell halign="left">
              <m>=-x_{?}</m>
            </cell>
          </row>
          <row>
            <cell halign="right" right="medium">
            </cell>
            <cell bottom="medium">
              <m>\cdots</m>
            </cell>
            <cell bottom="medium">
              <m>\cdots</m>
            </cell>
            <cell right="medium" bottom="medium">
              <m>\cdots</m>
            </cell>
            <cell right="medium" bottom="medium">
              <m>\vdots</m>
            </cell>
            <cell halign="left">
            </cell>
          </row>
          <row>
            <cell halign="right" right="medium">
            </cell>
            <cell bottom="medium">
              <m>\cdots</m>
            </cell>
            <cell bottom="medium">
              <m>c_t^*</m>
            </cell>
            <cell right="medium" bottom="medium">
              <m>\cdots</m>
            </cell>
            <cell right="medium" bottom="medium">
              <m>d</m>
            </cell>
            <cell halign="left">
              <m>=f</m>
            </cell>
          </row>
        </tabular>
      
        <tabular halign="center">
          <row>
            <cell halign="right">
            </cell>
            <cell bottom="medium">
              <m>\cdots</m>
            </cell>
            <cell bottom="medium">
              <m>x_?</m>
            </cell>
            <cell bottom="medium">
              <m>\cdots</m>
            </cell>
            <cell bottom="medium">
              <m>-1</m>
            </cell>
            <cell halign="left">
            </cell>
          </row>
          <row>
            <cell halign="right" right="medium">
            </cell>
            <cell>
              <m>\cdots</m>
            </cell>
            <cell>
              <m>\cdots</m>
            </cell>
            <cell right="medium">
              <m>\cdots</m>
            </cell>
            <cell right="medium">
              <m>\vdots</m>
            </cell>
            <cell halign="left">
            </cell>
          </row>
          <row>
            <cell halign="left" right="medium">
            </cell>
            <cell>
              <m>\vdots</m>
            </cell>
            <cell>
              <m>?</m>
            </cell>
            <cell right="medium">
              <m>\vdots</m>
            </cell>
            <cell right="medium">
              <m>0</m>
            </cell>
            <cell halign="left">
              <m>=-x_{t}</m>
            </cell>
          </row>
          <row>
            <cell halign="right" right="medium">
            </cell>
            <cell bottom="medium">
              <m>\cdots</m>
            </cell>
            <cell bottom="medium">
              <m>\cdots</m>
            </cell>
            <cell right="medium" bottom="medium">
              <m>\cdots</m>
            </cell>
            <cell right="medium" bottom="medium">
              <m>\vdots</m>
            </cell>
            <cell halign="left">
            </cell>
          </row>
          <row>
            <cell halign="right" right="medium">
            </cell>
            <cell bottom="medium">
              <m>\cdots</m>
            </cell>
            <cell bottom="medium">
              <m>?</m>
            </cell>
            <cell right="medium" bottom="medium">
              <m>\cdots</m>
            </cell>
            <cell right="medium" bottom="medium">
              <m>d</m>
            </cell>
            <cell halign="left">
              <m>=f</m>
            </cell>
          </row>
        </tabular>
      </sidebyside>
    </p>
    <p>
      Note that for this pivot to be valid, we must have that <m>c_t^*>0</m>.
      If we let <m>D_\ell</m> denote the dictionary before <m>x_t</m> re-enters the basis, we have:
      <me>
        f = \displaystyle\sum_{x_j\not\in B_\ell} c_{j}^*x_j -d
      </me>
      So note that the solution space to the system of equations for both these dictionaries are the same.  So we have a solution for <m>D_i</m> (not neccessarily feasible ie nonnegativity may fail) that must also be a solution to <m>D_\ell</m>:
      <md>
        <mrow>x_s \amp = Z </mrow>
        <mrow>x_j \amp = 0\text{ for }x_j\not\in B_i, x_j\neq x_s </mrow>
        <mrow>x_k \amp = b_k-a_{ks}Z \text{ for }x_k\in B_i</mrow>
        <mrow>f \amp = c_sZ-d. </mrow>
      </md>  
    </p>
    <p>
      So we have <me>c_sZ-d =f =c_s^*Z-d+\displaystyle\sum_{x_k\in B_i} c_{k}^*(b_k-a_{ks}Z)</me>
      where <m>c_k^*=0</m> for <m>x_k\in B_\ell</m>.  So via algebra:
      <me>\left( c_s-c_s^*  + \displaystyle\sum_{x_k\in B_i} c_{k}^*a_{ks} \right)Z = \displaystyle\sum_{x_k\in B_i} c_{k}^*b_k.</me>
    </p>
    <p>
      The above equation holds true no matter what <m>Z</m> is.  Thus:
      <me>c_s-c_s^*  + \displaystyle\sum_{x_k\in B_i} c_{k}^*a_{ks}=0.</me>
      Note that <m>x_t</m>, NOT <m>x_s</m> is entering the basis.  If <m>x_s</m> is already in the basis, <m>c_s^*=0</m>.  Otherwise, <m>c_s^*\leq0</m>, otherwise <m>s</m> would have entered by Bland's Anticyling rules.
      We've also shown <m>c_s>0</m>.  Thus <me>\displaystyle\sum_{x_k\in B_i} c_{k}^*a_{ks} \lt 0 </me> which
      is only possible if there is some <m>x_r\in B_i</m> such that <me>c_r^*a_{rs}\lt 0.</me>
    </p>
    <p>
      From this, we know that <m>c_r^*\neq 0</m>.  So <m>x_r\not\in B_\ell</m>, but <m>x_r\in B_i</m>, so <m>x_r</m> is fickle.  Since <m>t</m> is the 
      largest index of a fickle variable, <m>r\lt t</m>.  Note that <m>x_r</m> is not entering from <m>B_\ell</m>, so <m>c_r^*\leq 0</m>.  Thus <m>a_{rs}>0</m>.
    </p>
    <p>
      But <m>x_r</m> is fickle, so <m>b_r=0</m> in <m>D_i</m>.  But then, we would have picked <m>x_r</m>, not <m>x_t</m> to leave.
    </p>
    <p>
      <tabular halign="center">
        <row>
          <cell halign="right">
          </cell>
          <cell bottom="medium">
            <m>\cdots</m>
          </cell>
          <cell bottom="medium">
            <m>x_s</m>
          </cell>
          <cell bottom="medium">
            <m>\cdots</m>
          </cell>
          <cell bottom="medium">
            <m>-1</m>
          </cell>
          <cell halign="left">
          </cell>
        </row>
        <row>
          <cell halign="right" right="medium">
          </cell>
          <cell>
            <m>\cdots</m>
          </cell>
          <cell>
            <m>\cdots</m>
          </cell>
          <cell right="medium">
            <m>\cdots</m>
          </cell>
          <cell right="medium">
            <m>\vdots</m>
          </cell>
          <cell halign="left">
          </cell>
        </row>
        <row>
          <cell halign="left" right="medium">
          </cell>
          <cell>
            <m>\vdots</m>
          </cell>
          <cell>
            <m>a_{ts}</m>
          </cell>
          <cell right="medium">
            <m>\vdots</m>
          </cell>
          <cell right="medium">
            <m>0</m>
          </cell>
          <cell halign="left">
            <m>=-x_{t}</m>
          </cell>
        </row>
        <row>
          <cell halign="left" right="medium">
          </cell>
          <cell>
            <m>\vdots</m>
          </cell>
          <cell>
            <m>a_{rs}</m>
          </cell>
          <cell right="medium">
            <m>\vdots</m>
          </cell>
          <cell right="medium">
            <m>0</m>
          </cell>
          <cell halign="left">
            <m>=-x_{r}</m>
          </cell>
        </row>
        <row>
          <cell halign="right" right="medium">
          </cell>
          <cell bottom="medium">
            <m>\cdots</m>
          </cell>
          <cell bottom="medium">
            <m>\cdots</m>
          </cell>
          <cell right="medium" bottom="medium">
            <m>\cdots</m>
          </cell>
          <cell right="medium" bottom="medium">
            <m>\vdots</m>
          </cell>
          <cell halign="left">
          </cell>
        </row>
        <row>
          <cell halign="right" right="medium">
          </cell>
          <cell bottom="medium">
            <m>\cdots</m>
          </cell>
          <cell bottom="medium">
            <m>c_s</m>
          </cell>
          <cell right="medium" bottom="medium">
            <m>\cdots</m>
          </cell>
          <cell right="medium" bottom="medium">
            <m>d</m>
          </cell>
          <cell halign="left">
            <m>=f</m>
          </cell>
        </row>
      </tabular>
    </p>
    <p>
      which is a contradiction.
    </p>
  </proof>

  <activity>
    <statement>
      <p>
        If we follow <xref ref="thm-BlandAnticycling"/>, then no basis is visited twice during the Simplex
        Algorithm.  Note that <m>f</m> is nondecreasing with each pivot.  Must the Simplex Algorithm terminate?  Why?
      </p>
    </statement>
  </activity>
  



  

</section>